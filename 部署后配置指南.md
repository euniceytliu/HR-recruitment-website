# 🚀 部署后配置指南

## ⚠️ 重要说明

网站已经部署到线上，但 **AI 功能还需要你手动配置 API Key**！

因为 API Key 是私密信息，不能上传到 GitHub，所以需要在部署后单独配置。

---

## 📋 配置步骤

### 方式1：在本地电脑访问网站

如果你只是在自己电脑上使用网站：

1. **打开本地网站**
   - 直接打开 `diagnosis.html` 文件

2. **配置已完成**
   - 你的 API Key 已经在本地的 `zhipu-api-config.js` 文件中
   - 直接使用即可

---

### 方式2：部署到线上给其他人用（重要）

如果你想让其他人在线上访问你的网站并使用 AI 功能，需要做以下配置：

#### ⚠️ **警告：当前方案不适合公开部署**

当前的 AI 配置方案是将 API Key 暴露在前端的，**只适合个人使用**。

如果你要公开部署给其他人使用，会有以下风险：

1. **API Key 泄露**：任何人都能在浏览器中查看你的 API Key
2. **费用风险**：别人可能盗用你的 API Key，导致免费额度被耗尽
3. **安全问题**：恶意用户可能滥用你的 API

---

## 🔒 安全的公开部署方案

如果你确实需要公开部署，建议采用以下方案：

### 方案1：创建后端 API（推荐）

#### 架构：
```
用户 → 你的网站前端 → 你的后端API → 智谱AI
                         ↑
                    API Key存在这里
```

#### 步骤：

1. **创建后端服务**（使用 Vercel Serverless Functions）

创建文件 `/api/analyze-resume.js`：

```javascript
// Vercel Serverless Function
export default async function handler(req, res) {
    // 只允许POST请求
    if (req.method !== 'POST') {
        return res.status(405).json({ error: 'Method not allowed' });
    }

    const { resumeText, fileName } = req.body;

    // API Key 存储在环境变量中（不会暴露给前端）
    const ZHIPU_API_KEY = process.env.ZHIPU_API_KEY;

    try {
        const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${ZHIPU_API_KEY}`
            },
            body: JSON.stringify({
                model: 'glm-4-flash',
                messages: [{
                    role: 'user',
                    content: `分析简历...` // 你的完整 Prompt
                }],
                max_tokens: 2000
            })
        });

        const data = await response.json();
        return res.status(200).json(data);

    } catch (error) {
        return res.status(500).json({ error: error.message });
    }
}
```

2. **在 Vercel 配置环境变量**
   - 登录 Vercel Dashboard
   - 进入项目设置 → Environment Variables
   - 添加：`ZHIPU_API_KEY` = `你的真实API Key`

3. **前端调用你的API**

修改 `diagnosis.html` 中的代码：

```javascript
async function analyzeResumeWithAI(resumeText, fileName) {
    // 调用你的后端API，而不是直接调用智谱AI
    const response = await fetch('/api/analyze-resume', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ resumeText, fileName })
    });
    
    const result = await response.json();
    displayResult(result);
}
```

---

### 方案2：使用访问限制（简单但不完美）

如果你不想搭建后端，可以添加一些限制：

1. **IP 限制**：只允许特定 IP 访问
2. **密码保护**：添加访问密码
3. **使用量限制**：每天最多分析 X 份简历

但这些方案都不能完全防止 API Key 泄露。

---

## 💡 当前部署建议

**对于你的情况，我建议**：

### 1. **先使用本地版本**
   - 在自己电脑上打开 `diagnosis.html`
   - AI 功能正常使用
   - 不会有 API Key 泄露风险

### 2. **线上版本暂时禁用AI**
   - 部署的网站可以展示所有其他功能
   - AI 分析功能可以降级为智能关键词分析
   - 等需要公开使用AI时，再搭建后端

### 3. **需要时再搭建后端**
   - 如果你确实需要让其他人使用AI功能
   - 我可以帮你搭建 Vercel Serverless 后端
   - 大约需要 30 分钟配置

---

## 📁 相关文件说明

| 文件 | 说明 | 是否上传到GitHub |
|------|------|----------------|
| `zhipu-api-config.js` | 包含真实API Key | ❌ 不上传（.gitignore） |
| `zhipu-api-config.example.js` | 示例文件，不含真实Key | ✅ 上传 |
| `diagnosis.html` | 简历诊断页面 | ✅ 上传 |
| `.gitignore` | 忽略文件列表 | ✅ 上传 |

---

## ❓ 常见问题

### Q1: 为什么不能直接把 API Key 放在前端？
**A**: 任何人都能在浏览器控制台中查看前端代码，包括 API Key

### Q2: 如果我只是自己用，需要搭建后端吗？
**A**: 不需要！直接在本地使用就很安全

### Q3: 如何知道 API Key 是否泄露？
**A**: 在智谱AI控制台查看 API 调用量，如果异常增加说明可能泄露

### Q4: 如果 API Key 泄露了怎么办？
**A**: 立即在智谱AI控制台删除旧Key，创建新Key

---

## 🎯 下一步

你现在可以选择：

1. **仅本地使用** → 无需额外配置，直接用
2. **公开部署但禁用AI** → 继续当前部署流程
3. **公开部署 + AI功能** → 需要搭建后端（我可以帮你）

**你想选择哪个？**
