<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çƒ­æ‹›å²—ä½ - è…¾è®¯HRèŒä¸šæˆé•¿ä¼™ä¼´</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="jobs-style.css">
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">è…¾è®¯HRÂ·èŒä¸šæˆé•¿ä¼™ä¼´</div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">é¦–é¡µ</a></li>
                <li><a href="hr-day.html" class="nav-link">HRçš„ä¸€å¤©</a></li>
                <li><a href="hr-knowledge.html" class="nav-link">HRçŸ¥è¯†åº“</a></li>
                <li><a href="jobs.html" class="nav-link active">çƒ­æ‹›å²—ä½</a></li>
            </ul>
        </div>
    </nav>

    <!-- é¡¶éƒ¨åŒºåŸŸ -->
    <header>
        <h1>ğŸ”¥ è…¾è®¯HRåŸ¹è®­ç”Ÿçƒ­æ‹›</h1>
        <p class="welcome">å››å¤§æ–¹å‘ï¼Œæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ </p>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="jobs-main">
        <div class="jobs-intro">
            <h2>ğŸ’¼ äººåŠ›èµ„æºåŸ¹è®­ç”Ÿè®¡åˆ’</h2>
            <p>è…¾è®¯HRåŸ¹è®­ç”Ÿé¡¹ç›®ä¸ºåº”å±Šæ¯•ä¸šç”Ÿæä¾›ç³»ç»ŸåŒ–çš„èŒä¸šå‘å±•è·¯å¾„ã€‚æ ¹æ®ä½ çš„ç‰¹è´¨å’Œå…´è¶£ï¼Œæˆ‘ä»¬æä¾›<strong>å››å¤§ä¸“ä¸šæ–¹å‘</strong>ï¼Œæ¯ä¸ªæ–¹å‘éƒ½æœ‰æ¸…æ™°çš„æˆé•¿é€šé“å’Œå¯¼å¸ˆæ”¯æŒã€‚æ— è®ºä½ æ“…é•¿æ²Ÿé€šåä½œã€æ•°æ®åˆ†æã€åˆ›æ„ç­–åˆ’è¿˜æ˜¯äº§å“æŠ€æœ¯ï¼Œéƒ½èƒ½åœ¨è¿™é‡Œæ‰¾åˆ°å±äºä½ çš„èˆå°ï¼</p>
        </div>

        <!-- å²—ä½åˆ—è¡¨ -->
        <div class="jobs-container">
            <div class="loading">æ­£åœ¨åŠ è½½å²—ä½ä¿¡æ¯...</div>
        </div>

        <!-- è”ç³»ä¿¡æ¯ -->
        <div class="contact-section">
            <h2>ğŸ’¬ è”ç³»æˆ‘</h2>
            <p>å¦‚æœæ‚¨å¯¹ä»¥ä¸Šå²—ä½æ„Ÿå…´è¶£ï¼Œæˆ–æƒ³äº†è§£æ›´å¤šèŒä½ä¿¡æ¯ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ï¼š</p>
            <div class="contact-info">
                <p>ğŸ“§ é‚®ç®±ï¼šeunice@tencent.com</p>
                <p>ğŸ’¼ LinkedInï¼šlinkedin.com/in/eunice-liu</p>
                <p>ğŸ“± å¾®ä¿¡ï¼šè¯·é€šè¿‡é‚®ä»¶è·å–</p>
            </div>
            <p class="tip">ğŸ’¡ å°æç¤ºï¼šæŠ•é€’ç®€å†æ—¶è¯·æ³¨æ˜æ‚¨æ„Ÿå…´è¶£çš„å…·ä½“å²—ä½å’Œå·¥ä½œåœ°ç‚¹</p>
        </div>
    </main>

    <!-- åº•éƒ¨ -->
    <footer>
        <h3>è”ç³»æˆ‘</h3>
        <div class="contact">
            <p>ğŸ“§ é‚®ç®±ï¼šeunice@tencent.com</p>
            <p>ğŸ“± å¾®ä¿¡ï¼šè¯·é€šè¿‡é‚®ä»¶è·å–</p>
            <p>ğŸ’¼ LinkedInï¼šlinkedin.com/in/eunice-liu</p>
        </div>
        <p class="copyright">&copy; 2025 Eunice. All rights reserved.</p>
    </footer>

    <!-- å¼•å…¥Supabaseå®¢æˆ·ç«¯åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // ========== Supabaseé…ç½® ==========
        const SUPABASE_URL = 'https://gevvmjwjmpjhwczfuiru.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdldnZtandqbXBqaHdjemZ1aXJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyMTkyOTYsImV4cCI6MjA4MTc5NTI5Nn0.iA0eIjnudgmYHsVE_ioHTR8fR84oIciQqqNcbSBZ33I';

        // ========== æ•°æ®åº“æ“ä½œå‡½æ•° ==========
        async function getJobs(limit = 100) {
            try {
                const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                
                const { data, error } = await supabase
                    .from('jobs')
                    .select('*')
                    .eq('published', true)
                    .order('is_hot', { ascending: false })
                    .order('created_at', { ascending: false })
                    .limit(limit);

                if (error) {
                    console.error('âŒ æŸ¥è¯¢å¤±è´¥:', error);
                    return [];
                }

                return data || [];
            } catch (err) {
                console.error('âŒ å¼‚å¸¸:', err);
                return [];
            }
        }

        // æ¸²æŸ“å²—ä½åˆ—è¡¨
        function renderJobList(jobs, containerId = 'jobs-container') {
            const container = document.querySelector(`.${containerId}`);
            if (!container) {
                console.error('æœªæ‰¾åˆ°å®¹å™¨:', containerId);
                return;
            }

            if (!jobs || jobs.length === 0) {
                container.innerHTML = '<p class="no-jobs" style="text-align: center; padding: 40px; color: #666;">æš‚æ— æ‹›è˜å²—ä½</p>';
                return;
            }

            // è‡ªå®šä¹‰æ’åºï¼šæ²Ÿé€šå‹ã€åˆ†æå‹ã€åˆ›æ„å‹ã€äº§å“æŠ€æœ¯å‹
            const sortOrder = {
                'æ²Ÿé€šå‹': 1,
                'åˆ†æå‹': 2,
                'åˆ›æ„å‹': 3,
                'äº§å“æŠ€æœ¯': 4
            };

            const sortedJobs = jobs.sort((a, b) => {
                let orderA = 999;
                let orderB = 999;
                
                for (let key in sortOrder) {
                    if (a.title.includes(key)) orderA = sortOrder[key];
                    if (b.title.includes(key)) orderB = sortOrder[key];
                }
                
                return orderA - orderB;
            });

            // ç”Ÿæˆå²—ä½å¡ç‰‡HTML
            const jobsHTML = sortedJobs.map((job, index) => {
                const hotBadge = job.is_hot ? `<div class="job-badge">ğŸ”¥ çƒ­æ‹›</div>` : '';
                const requirements = job.requirements ? job.requirements.map(req => `<li>${req}</li>`).join('') : '';
                
                // æ ¹æ®ç±»å‹æ·»åŠ ä¸åŒçš„å›¾æ ‡å’Œé¢œè‰²
                let icon = 'ğŸ’¼';
                let colorClass = '';
                if (job.title.includes('æ²Ÿé€šå‹')) {
                    icon = 'ğŸ’¬';
                    colorClass = 'job-communication';
                } else if (job.title.includes('åˆ†æå‹')) {
                    icon = 'ğŸ“Š';
                    colorClass = 'job-analysis';
                } else if (job.title.includes('åˆ›æ„å‹')) {
                    icon = 'ğŸ¨';
                    colorClass = 'job-creative';
                } else if (job.title.includes('äº§å“æŠ€æœ¯')) {
                    icon = 'âš™ï¸';
                    colorClass = 'job-product';
                }
                
                return `
                    <div class="job-card ${job.is_hot ? 'hot' : ''} ${colorClass}">
                        ${hotBadge}
                        <div class="job-icon">${icon}</div>
                        <h3 class="job-title">${job.title}</h3>
                        <div class="job-info">
                            <span class="job-dept">ğŸ“ ${job.department || 'æœªçŸ¥éƒ¨é—¨'}</span>
                            <span class="job-location">ğŸ“Œ ${job.location || 'æœªçŸ¥åœ°ç‚¹'}</span>
                        </div>
                        <div class="job-requirements">
                            <h4>å²—ä½è¦æ±‚ï¼š</h4>
                            <ul>${requirements}</ul>
                        </div>
                        <a href="${job.apply_url || '#'}" class="apply-btn" target="_blank">ç«‹å³ç”³è¯· â†’</a>
                    </div>
                `;
            }).join('');

            container.innerHTML = jobsHTML;
        }

        // ========== é¡µé¢åŠ è½½é€»è¾‘ ==========
        document.addEventListener('DOMContentLoaded', async function() {
            if (typeof window.supabase === 'undefined') {
                console.error('âŒ Supabaseåº“æœªåŠ è½½');
                document.querySelector('.jobs-container').innerHTML = 
                    '<p class="error">Supabaseåº“åŠ è½½å¤±è´¥</p>';
                return;
            }
            
            try {
                console.log('å¼€å§‹åŠ è½½å²—ä½æ•°æ®...');
                const jobs = await getJobs();
                console.log('è·å–åˆ°å²—ä½æ•°æ®:', jobs);
                renderJobList(jobs, 'jobs-container');
            } catch (error) {
                console.error('âŒ åŠ è½½å¤±è´¥:', error);
                document.querySelector('.jobs-container').innerHTML = 
                    '<p class="error">åŠ è½½å²—ä½ä¿¡æ¯å¤±è´¥: ' + error.message + '</p>';
            }
        });
    </script>
</body>
</html>
